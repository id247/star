(function($) {	$(document).ready(function() {		//dnevnik_get_token();		get_six_image_to_gallery();		auto_assign_to_group();		vote();		photo_load();		open_gallery_from_upload_photo();		file_upload();		show_procentage();		see_more();		open_photo_pop_up();		jQuery('.token').val(jQuery.cookie('dnevnik_token'));	});	// Получаем токен доступа	function dnevnik_get_token(){		// Проверяем есть ли токен и хеш		if(jQuery.cookie('dnevnik_token') && location.hash.indexOf("#access_token") > -1){			// Также заносим токен в переменную			token = location.hash;	        // Заносим токен в куку	        jQuery.cookie('dnevnik_token', token);	        // Убираем хеш из урла 	        location.hash = '';		}		// Проверяем есть ли токен		else if(jQuery.cookie('dnevnik_token') && location.hash.indexOf("#access_token") == -1){			// Заносим токен из куки			token = jQuery.cookie('dnevnik_token');		}		else {			// Проверяем есть ли токен			if(location.hash.indexOf("#access_token") > -1) {		        // Также заносим токен в переменную		        token = location.hash;		        // Убираем хеш из урла 		        location.hash = '';		        // Заносим токен в куку		        jQuery.cookie('dnevnik_token', token);		    }		    else {		    	window.location.replace("https://login.dnevnik.ru/oauth2?response_type=token&client_id=65f0db372eb5403c88ab804e045e6c69&client_secret=558a0c63d8eb4a7c9fcd51b106d59668&scope=Avatar,FullName,Birthday,Age,Roles,Schools,EduGroups,Lessons,Marks,EduWorks,Relatives,Files,Contacts,Friends,Groups,Networks,Events,Wall,Messages,EmailAddress,Sex,SocialEntityMembership&redirect_uri=http://ad.dnevnik.ru/promo/star");		    }		}	}	function show_procentage(){		$('#pop-up-upload-photo #photo-upload').live('click', function(){			$('#pop-up-upload-photo form').fadeOut('slow');			$('#pop-up-upload-photo .load-photo').fadeIn('slow');		})	}	function photo_load(){		if(location.hash == '#wrong-format'){			$('#pop-up-upload-photo').show();			$('#pop-up-upload-photo .wrong-format').fadeIn('slow');			$('#pop-up-upload-photo form').hide();		}		if(location.hash == '#file-size"'){			$('#pop-up-upload-photo').show();			$('#pop-up-upload-photo .file-size').fadeIn('slow');			$('#pop-up-upload-photo form').hide();		}		if(location.hash == '#successfully'){			$('#pop-up-upload-photo').show();			$('#pop-up-upload-photo .successfully').fadeIn('slow');			$('#pop-up-upload-photo form').hide();		}		if(location.hash == '#error-load'){			$('#pop-up-upload-photo').show();			$('#pop-up-upload-photo .error-load').fadeIn('slow');			$('#pop-up-upload-photo form').hide();		}	}	function get_six_image_to_gallery(){	    jQuery.ajax({	        url: 'https://api.dnevnik.ru/v1/folder/2469784/files?'+token.substr(1),	        type: "GET",	        success: function(data){	        	if(data.length){					var byVote = data.slice(0);					byVote.sort(function(a,b) {					    var x = a.vote;					    var y = b.vote;					    return x < y ? -1 : x > y ? 1 : 0;					});					data = byVote.reverse()		        	$.each( data, function( key, value ) {		        		if(key <= 5){			        		html = $('<div class="img-like"><div class="galery-image"><img id="hover-image" src="https://ad.csdnevnik.ru/special/prodaction/dnevnik_star/images/hover-image.png" alt=""><img class="main-image" src="'+value['downloadUrl']+'"></div><div vote="'+value['id']+'" class="quantity clickable">'+value['vote']+'</div></div>');			        		$('.galery .all-image').append(html);		        		}		        		number_of_the_photos = $('.galery .all-image .img-like').length;		        	});	 	        	}	        	else {	        		number_of_the_photos = 0;	        	}	        	if(number_of_the_photos <= 6 && number_of_the_photos > 0){	        		num = (6 - number_of_the_photos);		        	for (var i = 0; i < num; i++) {		        		$('.galery .all-image').append('<div class="img-like"><img src="https://ad.csdnevnik.ru/special/prodaction/dnevnik_star/images/cap.png" alt="Альтернативное изображение"><div class="quantity">0</div></div>');					}	        	}	        		        	else {	        		num = (6);		        	for (var i = 0; i < num; i++) {		        		$('.galery .all-image').append('<div class="img-like"><img src="https://ad.csdnevnik.ru/special/prodaction/dnevnik_star/images/cap.png" alt="Альтернативное изображение"><div class="quantity">0</div></div>');					}	        	}     		        }	    });	}	function auto_assign_to_group(){        jQuery.ajax({            url: 'https://api.dnevnik.ru/v1/groups/306619/invite?'+token.substr(1),            type: "POST",            success: function(data){            	console.log(data)            }        });	}	function vote(){		$('.quantity.clickable, .likes').live('click', function(){			var vote_id = $(this).attr('vote');			var vote = $(this);	        jQuery.ajax({	            url: 'https://api.dnevnik.ru/v1/files/'+vote_id+'/like?'+token.substr(1),	            type: "POST",	            success: function(data){	            	vote.text(parseFloat($(vote).text() + 1));	            }	        });		});	}	function open_gallery_from_upload_photo(){		$('#pop-up-upload-photo .successfully .open-galery').live('click', function(){			$('#pop-up-upload-photo').hide();			$('#pop-up-images').show();			$('.image-and-like').remove();		    jQuery.ajax({		        url: 'https://api.dnevnik.ru/v1/folder/2469784/files?'+token.substr(1),		        type: "GET",		        success: function(data){		        	$.each( data, function( key, value ) {		        		if(key == 0){first = 'first active';}		        		else {first = '';}		        		html = $('<div class="image-and-like '+first+'"><div class="name">'+value['user']['fullName']+'</div><a target="_blank" href="'+value['pageUrl']+'"><img class="photo" src="'+value['downloadUrl']+'" alt="Фото"></a> <span vote="'+value['id']+'" class="likes">'+value['vote']+'</span><span class="social"><div class="share42init" data-url="'+value['pageUrl']+'" data-title="" data-image="'+value['downloadUrl']+'" data-icons-file="my-icons.png"></div><script type="text/javascript" src="https://ad.csdnevnik.ru/special/prodaction/dnevnik_star/share42/share42.js"></script></span></div>');		        		$('#pop-up-images .content').append(html);		        		console.log(value)		        	});	   			        }		    });		});	}	function file_upload(){		$('.fifth .button').live('click', function(){			$('.successfully, .wrong-format, .file-size, .error-load').hide();			$('#pop-up-upload-photo form').show();		});	}	function see_more(){		$('.sixth .button').live('click', function(){			$('#pop-up-images').fadeIn('slow');			$('.image-and-like').remove();		    jQuery.ajax({		        url: 'https://api.dnevnik.ru/v1/folder/2469784/files?'+token.substr(1),		        type: "GET",		        success: function(data){		        	$.each( data, function( key, value ) {		        		if(key == 0){first = 'first active';}		        		else {first = '';}		        		html = $('<div class="image-and-like '+first+'"><div class="name">'+value['user']['fullName']+'</div><a target="_blank" href="'+value['pageUrl']+'"><img class="photo" src="'+value['downloadUrl']+'" alt="Фото"></a> <span vote="'+value['id']+'" class="likes">'+value['vote']+'</span><span class="social"><div class="share42init" data-url="'+value['pageUrl']+'" data-title="" data-image="'+value['downloadUrl']+'" data-icons-file="my-icons.png"></div><script type="text/javascript" src="https://ad.csdnevnik.ru/special/prodaction/dnevnik_star/share42/share42.js"></script></span></div>');		        		$('#pop-up-images .content').append(html);		        	});	   			        	$('.image-and-like:last').addClass('last');		        }		    });		});	}	function open_photo_pop_up(){		$('#hover-image').live('click', function(){			var id_to_active = $(this).parents('.img-like').find('.quantity').attr('vote');			$('#pop-up-images').fadeIn('slow');			$('.image-and-like').remove();		    jQuery.ajax({		        url: 'https://api.dnevnik.ru/v1/folder/2469784/files?'+token.substr(1),		        type: "GET",		        success: function(data){		        	$.each( data, function( key, value ) {		        		html = $('<div id="active-'+value['id']+'" class="image-and-like"><div class="name">'+value['user']['fullName']+'</div><a target="_blank" href="'+value['pageUrl']+'"><img class="photo" src="'+value['downloadUrl']+'" alt="Фото"></a> <span vote="'+value['id']+'" class="likes">'+value['vote']+'</span><span class="social"><div class="share42init" data-url="'+value['pageUrl']+'" data-image="'+value['downloadUrl']+'" data-title="" data-icons-file="my-icons.png"></div><script type="text/javascript" src="https://ad.csdnevnik.ru/special/prodaction/dnevnik_star/share42/share42.js"></script></span></div>');		        		$('#pop-up-images .content').append(html);		        	});		        	$('#active-'+id_to_active).addClass('first active').insertAfter('#pop-up-images .content .next')		        	$('.image-and-like:last').addClass('last');		        }		    });		})	}  })(jQuery);